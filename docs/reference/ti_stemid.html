<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Inferring trajectories with StemID — ti_stemid • dyno</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Inferring trajectories with StemID — ti_stemid" />

<meta property="og:description" content="Inferring trajectories with StemID
Will generate a trajectory using StemID. This method was wrapped inside a container." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dyno</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dyno.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dynverse/dyno">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Inferring trajectories with StemID</h1>
    <small class="dont-index">Source: <a href='https://github.com/dynverse/dyno/blob/master/R/ti_stemid.R'><code>R/ti_stemid.R</code></a>, <a href='https://github.com/dynverse/dyno/blob/master/R/ti_container.R'><code>R/ti_container.R</code></a></small>
    <div class="hidden name"><code>ti_stemid.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Inferring trajectories with StemID</p>
<p>Will generate a trajectory using <a href='https://doi.org/10.1016/j.stem.2016.05.010'>StemID</a>. This method was wrapped inside a <a href='https://github.com/dynverse/dynmethods/tree/master/containers/stemid'>container</a>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ti_stemid</span>(<span class='kw'>docker</span> <span class='kw'>=</span> <span class='kw pkg'>dynwrap</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/dynwrap/topics/test_docker_installation'>test_docker_installation</a></span>(), <span class='kw'>clustnr</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>bootnr</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>num_cluster_method</span> <span class='kw'>=</span> <span class='st'>"sat"</span>,
  <span class='kw'>SE.method</span> <span class='kw'>=</span> <span class='st'>"Tibs2001SEmax"</span>, <span class='kw'>SE.factor</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>B.gap</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>cln</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>FUNcluster</span> <span class='kw'>=</span> <span class='st'>"kmedoids"</span>, <span class='kw'>dimred_method</span> <span class='kw'>=</span> <span class='st'>"tsne"</span>, <span class='kw'>outminc</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>outlg</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>probthr</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>thr_lower</span> <span class='kw'>=</span> -<span class='fl'>10</span>, <span class='kw'>thr_upper</span> <span class='kw'>=</span> -<span class='fl'>5</span>,
  <span class='kw'>outdistquant</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>nmode</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>pdishuf</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pthr</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>,
  <span class='kw'>pethr</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>pvalue_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>linkscore_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)

<span class='fu'>ti_stemid</span>(<span class='kw'>docker</span> <span class='kw'>=</span> <span class='kw pkg'>dynwrap</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/dynwrap/topics/test_docker_installation'>test_docker_installation</a></span>(), <span class='kw'>clustnr</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>bootnr</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>num_cluster_method</span> <span class='kw'>=</span> <span class='st'>"sat"</span>,
  <span class='kw'>SE.method</span> <span class='kw'>=</span> <span class='st'>"Tibs2001SEmax"</span>, <span class='kw'>SE.factor</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>B.gap</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>cln</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>FUNcluster</span> <span class='kw'>=</span> <span class='st'>"kmedoids"</span>, <span class='kw'>dimred_method</span> <span class='kw'>=</span> <span class='st'>"tsne"</span>, <span class='kw'>outminc</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>outlg</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>probthr</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>thr_lower</span> <span class='kw'>=</span> -<span class='fl'>10</span>, <span class='kw'>thr_upper</span> <span class='kw'>=</span> -<span class='fl'>5</span>,
  <span class='kw'>outdistquant</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>nmode</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>pdishuf</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pthr</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>,
  <span class='kw'>pethr</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>pvalue_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>linkscore_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>docker</th>
      <td><p>Whether to use the docker container or the R wrapper</p></td>
    </tr>
    <tr>
      <th>clustnr</th>
      <td><p>maximum number of clusters for the computation of the gap statistic or derivation of the cluster number by the saturation criterion. Default is 30. If more major cell types are expected a higher number should be chosen.</p></td>
    </tr>
    <tr>
      <th>bootnr</th>
      <td><p>number of booststrapping runs for clusterboot. Default is 50</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>the input data are transformed to a distance object. Distances can be computed based on different metrics. Possible values are "pearson", "spearman", "logpearson", "euclidean", "kendall", "maximum", "manhattan", "canberra", "binary" or "minkowski". Default is "pearson". In case of the correlation based methods, the distance is computed as 1 - correlation. K-medoids clustering is performed on this distance object.</p></td>
    </tr>
    <tr>
      <th>num_cluster_method</th>
      <td><p>the type of clustering method, can be sat, gap or manual</p></td>
    </tr>
    <tr>
      <th>SE.method</th>
      <td><p>the clustering routine calls a modified version of the maxSE function from the cluster package to determine the first local maximum of the gap statistic. By default, we use the method "Tibs2001SEmax" for calling the first local maximum (see specification of maxSE). This method requires that the maximum exceeds the values of its neighbors by a fraction of their standard deviation. This fraction is defined by the parameter SE.factor. All methods defined for the original maxSE function can also be used.</p></td>
    </tr>
    <tr>
      <th>SE.factor</th>
      <td><p>fraction of the standard deviation by which the local maximum is required to differ from the neighboring points it is compared to. Default is 0.25.</p></td>
    </tr>
    <tr>
      <th>B.gap</th>
      <td><p>number of bootstrap runs for the calculation of the gap statistic. Default is 50.</p></td>
    </tr>
    <tr>
      <th>cln</th>
      <td><p>the number of clusters for k-medoids clustering. Default is 0. In this case, the cluster number is determined based on the gap statistic6 and do.gap has to be TRUE.</p></td>
    </tr>
    <tr>
      <th>FUNcluster</th>
      <td><p>the clustering method applied. One of the following methods can be selected: kmedoids, kmeans, hclust. RaceID3 is designed for k-medoids clustering and therefore it is recommended to use only the kmedoids method. Default is kmedoids.</p></td>
    </tr>
    <tr>
      <th>dimred_method</th>
      <td><p>the dimensionality reduction method, can be tsne, sammon or tsne_initcmd</p></td>
    </tr>
    <tr>
      <th>outminc</th>
      <td><p>expression cutoff for the identification of outlier genes is defined. Default is 5.</p></td>
    </tr>
    <tr>
      <th>outlg</th>
      <td><p>minimal number of outlier genes required to identify a cell as an outlier. Default is 2.</p></td>
    </tr>
    <tr>
      <th>probthr</th>
      <td><p>defines the probability threshold for outlier calling. If the probability of observing a given expression level for a gene in a cell is lower than this cutoff (based on the negative binomial distribution for the calibrated noise model), the cell is considered an outlier for this gene. Default is 10-3.</p></td>
    </tr>
    <tr>
      <th>thr_lower</th>
      <td><p>lower probability for which the number of outliers is computed in order to plot the dependence of the number of outliers on the probability threshold</p></td>
    </tr>
    <tr>
      <th>thr_upper</th>
      <td><p>upper probability for which the number of outliers is computed in order to plot the dependence of the number of outliers on the probability threshold</p></td>
    </tr>
    <tr>
      <th>outdistquant</th>
      <td><p>outlier cells are merged to outlier clusters if their similarity exceeds the outdistquant-quantile of the similarity distribution for all pairs of cells that are together in one of the original clusters. Default is 0.95.</p></td>
    </tr>
    <tr>
      <th>nmode</th>
      <td><p>Boolean argument. If nmode is set to TRUE the assignment to inter-cluster links for each cell is not done based on the longest projection, but based on identifying the cluster (other than the cluster the cell belongs to) that contains the nearest neighbor of the cell, i. e. the cell with the most similar transcriptome. The coordinate on the assigned link is still derived based on the projection. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>pdishuf</th>
      <td><p>positive integer. This is the number of randomizations to be performed. As a rule of thumb this number should be at least one order of magnitude larger than the desired p-value on the significance of the number of cells on a connection. Default is 2000.</p></td>
    </tr>
    <tr>
      <th>pthr</th>
      <td><p>positive number. This number corresponds to the p-value threshold, which is used to determine, whether the magnitude of an observed trajectory is significantly larger than observed for the randomized background distribution. This criterion is not used to infer significance of a link, but shown in a graphical representation of the tree</p></td>
    </tr>
    <tr>
      <th>pethr</th>
      <td><p>positive number. This number corresponds to the p-value threshold, which isused to determine for each link if it is populated by a number of cellssignificantly larger than expected for the randomized background distribution. This p-value threshold determines, which connections are considered validdifferentiation trajectories in the derived lineage tree.</p></td>
    </tr>
    <tr>
      <th>pvalue_cutoff</th>
      <td><p>Upper cutoff of p-value for determining significant edges</p></td>
    </tr>
    <tr>
      <th>linkscore_cutoff</th>
      <td><p>Lower cutoff of the linkscore for determining significant edges</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The trajectory model</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This methods was first wrapped inside R, see ti_stemid</p>
<p>The original code of this method is available <a href='https://github.com/dgrun/StemID'>here</a>.</p>
<p>The method is described in: <a href='https://doi.org/10.1016/j.stem.2016.05.010'>Grün, D., Muraro, M.J., Boisset, J.-C., Wiebrands, K., Lyubimova, A., Dharmadhikari, G., van den Born, M., van Es, J., Jansen, E., Clevers, H., de Koning, E.J.P., van Oudenaarden, A., 2016. De Novo Prediction of Stem Cell Identity using Single-Cell Transcriptome Data. Cell Stem Cell 19, 266–277.</a></p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Robrecht Cannoodt, Wouter Saelens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

